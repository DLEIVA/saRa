
# This file is automatically generated, you probably don't want to edit this

discvarsOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "discvarsOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            distros = "binom",
            binomn = 10,
            binomp = 0.5,
            lambda = NULL,
            valuesfunc = NULL,
            pmf = FALSE,
            cdf = FALSE,
            surv = FALSE,
            icdf = FALSE,
            qvalues = NULL, ...) {

            super$initialize(
                package="saRa",
                name="discvars",
                requiresData=FALSE,
                ...)

            private$..distros <- jmvcore::OptionList$new(
                "distros",
                distros,
                options=list(
                    "binom",
                    "poiss"),
                default="binom")
            private$..binomn <- jmvcore::OptionInteger$new(
                "binomn",
                binomn,
                default=10)
            private$..binomp <- jmvcore::OptionNumber$new(
                "binomp",
                binomp,
                default=0.5)
            private$..lambda <- jmvcore::OptionNumber$new(
                "lambda",
                lambda)
            private$..valuesfunc <- jmvcore::OptionString$new(
                "valuesfunc",
                valuesfunc)
            private$..pmf <- jmvcore::OptionBool$new(
                "pmf",
                pmf,
                default=FALSE)
            private$..cdf <- jmvcore::OptionBool$new(
                "cdf",
                cdf,
                default=FALSE)
            private$..surv <- jmvcore::OptionBool$new(
                "surv",
                surv,
                default=FALSE)
            private$..icdf <- jmvcore::OptionBool$new(
                "icdf",
                icdf,
                default=FALSE)
            private$..qvalues <- jmvcore::OptionString$new(
                "qvalues",
                qvalues)

            self$.addOption(private$..distros)
            self$.addOption(private$..binomn)
            self$.addOption(private$..binomp)
            self$.addOption(private$..lambda)
            self$.addOption(private$..valuesfunc)
            self$.addOption(private$..pmf)
            self$.addOption(private$..cdf)
            self$.addOption(private$..surv)
            self$.addOption(private$..icdf)
            self$.addOption(private$..qvalues)
        }),
    active = list(
        distros = function() private$..distros$value,
        binomn = function() private$..binomn$value,
        binomp = function() private$..binomp$value,
        lambda = function() private$..lambda$value,
        valuesfunc = function() private$..valuesfunc$value,
        pmf = function() private$..pmf$value,
        cdf = function() private$..cdf$value,
        surv = function() private$..surv$value,
        icdf = function() private$..icdf$value,
        qvalues = function() private$..qvalues$value),
    private = list(
        ..distros = NA,
        ..binomn = NA,
        ..binomp = NA,
        ..lambda = NA,
        ..valuesfunc = NA,
        ..pmf = NA,
        ..cdf = NA,
        ..surv = NA,
        ..icdf = NA,
        ..qvalues = NA)
)

discvarsResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "discvarsResults",
    inherit = jmvcore::Group,
    active = list(
        InfoTab = function() private$.items[["InfoTab"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Discrete Distributions")
            self$add(jmvcore::Table$new(
                options=options,
                name="InfoTab",
                title="Distribution information",
                rows=1,
                columns=list(
                    list(
                        `name`="DistributionColumn", 
                        `title`="Distribution", 
                        `type`="text"),
                    list(
                        `name`="ParametersColumn", 
                        `title`="Parameter(s)", 
                        `type`="text", 
                        `visible`="(distros)"))))}))

discvarsBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "discvarsBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "saRa",
                name = "discvars",
                version = c(0,1,0),
                options = options,
                results = discvarsResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'na')
        }))

#' Discrete Distributions
#'
#' 
#' @param distros \code{binom} (default), \code{poiss}, 'negbinom', 'geom', or
#'   \code{hypergeom}, specifies binomial, poisson, negative binomial, geometric
#'   or hypergeometric distributions
#' @param binomn a number specifying number of trials in binomial distribution
#' @param binomp a number specifying success probability in binomial
#'   distribution
#' @param lambda lambda parameter for Poisson distribution
#' @param valuesfunc a comma-separated list specifying random variables'
#'   values
#' @param pmf \code{TRUE} or \code{FALSE} (default), provide probability mass
#'   function for a discrete distribution
#' @param cdf \code{TRUE} or \code{FALSE} (default), provide cumulative
#'   distribution function for a discrete distribution
#' @param surv \code{TRUE} or \code{FALSE} (default), provide survival
#'   function for a discrete distribution
#' @param icdf \code{TRUE} or \code{FALSE} (default), provide inverse of
#'   cumulative distribution function for a discrete distribution
#' @param qvalues a comma-separated list specifying quantiles for a random
#'   variable
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$InfoTab} \tab \tab \tab \tab \tab a table \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$InfoTab$asDF}
#'
#' \code{as.data.frame(results$InfoTab)}
#'
#' @export
discvars <- function(
    distros = "binom",
    binomn = 10,
    binomp = 0.5,
    lambda,
    valuesfunc,
    pmf = FALSE,
    cdf = FALSE,
    surv = FALSE,
    icdf = FALSE,
    qvalues) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("discvars requires jmvcore to be installed (restart may be required)")


    options <- discvarsOptions$new(
        distros = distros,
        binomn = binomn,
        binomp = binomp,
        lambda = lambda,
        valuesfunc = valuesfunc,
        pmf = pmf,
        cdf = cdf,
        surv = surv,
        icdf = icdf,
        qvalues = qvalues)

    analysis <- discvarsClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

